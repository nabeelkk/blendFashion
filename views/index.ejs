<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Style - Premium Fashion Destination</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style1.css">
</head>
<body>
    <style>
            a{
                font-size: 16px;;
                color: black;
                text-decoration: none;
                list-style: none;
            }
            li{
                text-decoration: none;
                list-style: none;
            }
        .product-image{
            position: relative;
        }
        .pillHigh{
            border: 1px solid transparent;
            border-radius: 20px;
            margin-top: 10px;
            cursor: pointer;
            text-align: center;
            width: fit-content;
            padding-left: 10px;
            padding-right: 10px;
            position: absolute;
            top: 3px;
            left: 14px;
        }
        .product-image{
            transition: .3s;
        }
        .product-image:hover{
            transform: scale(1.03);
            cursor: pointer;
            
        }
        .star-rating {
            display: flex;
            gap: 5px;
            font-size: 30px;
            cursor: pointer;
            color: #ccc;
        }

        .star-rating .star.selected,
        .star-rating .star.hovered {
            color: gold;
        }
    </style>
    <!-- Header -->
    <%- include('./partials/navbar') %>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6 hero-content">
                    <% if (user) { %>
                        <h1 class="display-4 fw-bold mb-3">Welcome Back,<br><span style="font-size: 45px;"> <%= user.name %> !</span></h1>
                        <% } else { %>
                            <h1 class="display-4 fw-bold mb-3">Welcome to, <br><span style="font-size: 45px;">Blend Fashion  </span></h1>
                    <% } %>
                    
                    <p class="lead mb-4">Discover our latest collections and exclusive offers tailored just for you.</p>
                    <div class="d-flex flex-wrap">
                        <% if (!user) { %>
                            <a href="/login" class="btn btn-dark btn-lg me-2 mb-2">Shop Now</a>
                            <a href="/login" class="btn btn-outline-dark btn-lg mb-2">View Wishlist</a>
                            <% } else { %>
                                <a href="/category" class="btn btn-dark btn-lg me-2 mb-2">Shop Now</a>
                                <a href="/wishlist" class="btn btn-outline-dark btn-lg mb-2">View Wishlist</a>
                        <% } %>
                        
                    </div>
                </div>
                <div class="col-lg-6 hero-image">
                    <img src="/img/banner/770270_ZAPEU_9376_002_100_0000_Light-Gucci-pixel-print-nylon-jacket.jpg.avif" alt="Hero Image" class="img-fluid">
                </div>
            </div>
        </div>
    </section>

    <!-- Personalized Recommendations -->
    <section class="personalized-recommendations py-5">
        <div class="container">
            <h2 class="section-title">Recommended For You</h2>
            <p class="text-muted mb-4">Based on your browsing history and preferences</p>
                <div class="row">
                    <!-- Product 1 -->
                    <% products.forEach(element => { %>
                    <div class="col-6 col-md-3 mb-4">
                        <div class="product-card">
                            <a href="products">
                            <div class="product-image">
                                <img src="https://res.cloudinary.com/<%= cloudName %>/image/upload/<%= element.images[0] %>" alt="Premium Cotton Shirt" class="img-fluid">
                                <% if (element.sizes?.small?.amount) { %>
                                 <div class="product-badge bg-danger text-white pillHigh"><%= element.sizes.small.amount %>% Offer</div>
                                <% } %>
                            </div>
                            </a>
                            <div class="product-info pt-3">
                                <a href="products">
                                    <h5 class="product-title"><%= element.name %></h5>
                                </a>
                                <p class="product-brand text-muted "><%= element.brand%></p>
                                <div class="rating-container mt-0">
                                    <div class="star-rating" id="starRating">
                                        <span class="star" data-value="1">&#9733;</span>
                                        <span class="star" data-value="2">&#9733;</span>
                                        <span class="star" data-value="3">&#9733;</span>
                                        <span class="star" data-value="4">&#9733;</span>
                                        <span class="star" data-value="5">&#9733;</span>
                                    </div>
                                    <input type="hidden" name="rating" id="ratingValue" value="0">
                                </div>
                                <div class="d-flex justify-content-between align-items-center">
                                    <p class="product-price mb-0">₹<%= Math.round((element.sizes.small.Mrp - (element.sizes?.small?.Mrp * element.sizes?.small?.amount) / 100)) || element.sizes.small.Mrp %>.00 <% if (element.sizes?.small?.amount) { %>
                                     <span class="text-decoration-line-through text-muted fs-6">₹<%= element.sizes.small.Mrp %>.00</span>
                                    <% } %></p>
                                    <a href="login" class="product-wishlist wishlist-icon" data-id="<%= element._id %>" onclick="toggleWishlist(this, event,'<%=element._id%>')"><i class="far fa-heart"></i></a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <% }) %>
                </div>
               
        </div>
    </section>

    <!-- New Arrivals -->
    <section class="new-arrivals py-5 bg-light">
            <div class="container">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div>
                        <h2 class="section-title mb-0">New Arrivals</h2>
                        <p class="text-muted">Fresh styles added this week</p>
                    </div>
                    <a href="login" class="btn btn-outline-dark">View All</a>
                </div>
               
                <div class="row">
                    <!-- Product 1 -->
                    <% products.forEach(element => { %>
                    <div class="col-6 col-md-3 mb-4">
                        <div class="product-card">
                            <a href="products">
                            <div class="product-image">
                                <img src="https://res.cloudinary.com/<%= cloudName %>/image/upload/<%= element.images[0] %>" alt="Premium Cotton Shirt" class="img-fluid">
                                <% if (element.sizes?.small?.amount) { %>
                                 <div class="product-badge bg-danger text-white pillHigh"><%= element.sizes.small.amount %>% Offer</div>
                                <% } %>
                            </div>
                            </a>
                            <div class="product-info pt-3">
                                <a href="products">
                                    <h5 class="product-title"><%= element.name %></h5>
                                </a>
                                <p class="product-brand text-muted "><%= element.brand%></p>
                                <div class="rating-container mt-0">
                                    <div class="star-rating" id="starRating">
                                        <span class="star" data-value="1">&#9733;</span>
                                        <span class="star" data-value="2">&#9733;</span>
                                        <span class="star" data-value="3">&#9733;</span>
                                        <span class="star" data-value="4">&#9733;</span>
                                        <span class="star" data-value="5">&#9733;</span>
                                    </div>
                                    <input type="hidden" name="rating" id="ratingValue" value="0">
                                </div>
                                <div class="d-flex justify-content-between align-items-center">
                                    <p class="product-price mb-0">₹<%= Math.round((element.sizes.small.Mrp - (element.sizes?.small?.Mrp * element.sizes?.small?.amount) / 100)) || element.sizes.small.Mrp %>.00 <% if (element.sizes?.small?.amount) { %>
                                     <span class="text-decoration-line-through text-muted fs-6">₹<%= element.sizes.small.Mrp %>.00</span>
                                    <% } %></p>
                                    <a href="login" class="product-wishlist wishlist-icon" data-id="<%= element._id %>" onclick="toggleWishlist(this, event,'<%=element._id%>')"><i class="far fa-heart"></i></a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <% }) %>
                </div>
                
            </div>
        
    </section>

    <!-- Limited Offer -->
    <section class="limited-offer py-5">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6 mb-4 mb-lg-0">
                    <img src="/uploads/1744008623659-128482557.jpg" alt="Limited Offer" class="img-fluid rounded">
                </div>
                <div class="col-lg-6">
                    <div class="limited-offer-content">
                        <h6 class="text-danger mb-2">Limited Time Offer</h6>
                        <h2 class="mb-3">Exclusive Collection</h2>
                        <p class="mb-4">Get up to 50% off on our premium collection. Offer valid for a limited time only.</p>
                        <div class="countdown d-flex mb-4">
                            <div class="countdown-item me-2">
                                <span class="days">02</span>
                                <p>Days</p>
                            </div>
                            <div class="countdown-item me-2">
                                <span class="hours">12</span>
                                <p>Hours</p>
                            </div>
                            <div class="countdown-item me-2">
                                <span class="minutes">45</span>
                                <p>Mins</p>
                            </div>
                            <div class="countdown-item">
                                <span class="seconds">30</span>
                                <p>Secs</p>
                            </div>
                        </div>
                        <% if (!user) { %>
                            <a href="login" class="btn btn-dark">Shop Now</a>
                            <% } else { %>
                                <a href="category.html" class="btn btn-dark">Shop Now</a>
                        <% } %>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Featured Brands -->
    <section class="featured-brands py-5 bg-light">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div>
                    <h2 class="section-title mb-0">Featured Brands</h2>
                    <p class="text-muted">Shop your favorite luxury brands</p>
                </div>
                <a href="brands.html" class="btn btn-outline-dark">View All</a>
            </div>
            <div class="row">
                <!-- Brand 1 -->
                <div class="col-6 col-md-3 mb-4">
                    <div class="brand-card">
                        <img src="/adminassets/imgs/brands/brand-1.jpg" alt="Gucci" class="img-fluid">
                        <div class="brand-overlay d-flex align-items-center justify-content-center">
                            <div class="text-center">
                                <h3 class="brand-name mb-3">Gucci</h3>
                                <a href="category.html" class="btn btn-outline-light">Shop Now</a>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Brand 2 -->
                <div class="col-6 col-md-3 mb-4">
                    <div class="brand-card">
                        <img src="/adminassets/imgs/brands/brand-10.jpg" alt="Prada" class="img-fluid">
                        <div class="brand-overlay d-flex align-items-center justify-content-center">
                            <div class="text-center">
                                <h3 class="brand-name mb-3">Prada</h3>
                                <a href="category.html" class="btn btn-outline-light">Shop Now</a>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Brand 3 -->
                <div class="col-6 col-md-3 mb-4">
                    <div class="brand-card">
                        <img src="/adminassets/imgs/brands/brand-11.jpg" alt="Burberry" class="img-fluid">
                        <div class="brand-overlay d-flex align-items-center justify-content-center">
                            <div class="text-center">
                                <h3 class="brand-name mb-3">Burberry</h3>
                                <a href="category.html" class="btn btn-outline-light">Shop Now</a>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Brand 4 -->
                <div class="col-6 col-md-3 mb-4">
                    <div class="brand-card">
                        <img src="/adminassets/imgs/brands/brand-13.jpg" alt="Armani" class="img-fluid">
                        <div class="brand-overlay d-flex align-items-center justify-content-center">
                            <div class="text-center">
                                <h3 class="brand-name mb-3">Armani</h3>
                                <a href="category.html" class="btn btn-outline-light">Shop Now</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Trending Products -->
    <section class="trending-products py-5">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div>
                    <h2 class="section-title mb-0">Trending Now</h2>
                    <p class="text-muted">Most popular items this season</p>
                </div>
                <a href="category.html" class="btn btn-outline-dark">View All</a>
            </div>
            <div class="row">
                    <!-- Product 1 -->
                    <% products.forEach(element => { %>
                    <div class="col-6 col-md-3 mb-4">
                        <div class="product-card">
                            <a href="products">
                            <div class="product-image">
                                <img src="https://res.cloudinary.com/<%= cloudName %>/image/upload/<%= element.images[0] %>" alt="Premium Cotton Shirt" class="img-fluid">
                                <% if (element.sizes?.small?.amount) { %>
                                 <div class="product-badge bg-danger text-white pillHigh"><%= element.sizes.small.amount %>% Offer</div>
                                <% } %>
                            </div>
                            </a>
                            <div class="product-info pt-3">
                                <a href="products">
                                    <h5 class="product-title"><%= element.name %></h5>
                                </a>
                                <p class="product-brand text-muted "><%= element.brand%></p>
                                <div class="rating-container mt-0">
                                    <div class="star-rating" id="starRating">
                                        <span class="star" data-value="1">&#9733;</span>
                                        <span class="star" data-value="2">&#9733;</span>
                                        <span class="star" data-value="3">&#9733;</span>
                                        <span class="star" data-value="4">&#9733;</span>
                                        <span class="star" data-value="5">&#9733;</span>
                                    </div>
                                    <input type="hidden" name="rating" id="ratingValue" value="0">
                                </div>
                                <div class="d-flex justify-content-between align-items-center">
                                    <p class="product-price mb-0">₹<%= Math.round((element.sizes.small.Mrp - (element.sizes?.small?.Mrp * element.sizes?.small?.amount) / 100)) || element.sizes.small.Mrp %>.00 <% if (element.sizes?.small?.amount) { %>
                                     <span class="text-decoration-line-through text-muted fs-6">₹<%= element.sizes.small.Mrp %>.00</span>
                                    <% } %></p>
                                    <a href="login" class="product-wishlist wishlist-icon" data-id="<%= element._id %>" onclick="toggleWishlist(this, event,'<%=element._id%>')"><i class="far fa-heart"></i></a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <% }) %>
                </div>
        </div>
    </section>

    <!-- Features -->
    <section class="features py-5 bg-light">
        <div class="container">
            <div class="row">
                <div class="col-md-3 mb-4 mb-md-0">
                    <div class="feature-card p-4 text-center h-100">
                        <div class="feature-icon mb-3">
                            <i class="fas fa-truck fa-2x"></i>
                        </div>
                        <h5>Free Shipping</h5>
                        <p class="mb-0">On orders over $100</p>
                    </div>
                </div>
                <div class="col-md-3 mb-4 mb-md-0">
                    <div class="feature-card p-4 text-center h-100">
                        <div class="feature-icon mb-3">
                            <i class="fas fa-undo fa-2x"></i>
                        </div>
                        <h5>Easy Returns</h5>
                        <p class="mb-0">30-day return policy</p>
                    </div>
                </div>
                <div class="col-md-3 mb-4 mb-md-0">
                    <div class="feature-card p-4 text-center h-100">
                        <div class="feature-icon mb-3">
                            <i class="fas fa-lock fa-2x"></i>
                        </div>
                        <h5>Secure Payment</h5>
                        <p class="mb-0">100% secure checkout</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="feature-card p-4 text-center h-100">
                        <div class="feature-icon mb-3">
                            <i class="fas fa-headset fa-2x"></i>
                        </div>
                        <h5>24/7 Support</h5>
                        <p class="mb-0">Dedicated support team</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Newsletter -->
    <section class="newsletter py-5">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-6 text-center">
                    <h3 class="mb-3">Subscribe to Our Newsletter</h3>
                    <p class="mb-4">Get the latest updates on new products and upcoming sales</p>
                    <form class="newsletter-form">
                        <div class="input-group mb-3">
                            <input type="email" class="form-control" placeholder="Your Email Address" aria-label="Your Email Address">
                            <button class="btn btn-dark" type="submit">Subscribe</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <%- include('./partials/footer') %>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script src="js/script.js"></script>
    <script>
        // Toggle wishlist heart icon
        // Toggle wishlist heart icon
        document.addEventListener('DOMContentLoaded', restoreWishlistIcons);
        function toggleWishlist(element, event, id) {
            event.preventDefault();
            const icon = element.querySelector('i');

            // Check if item is already in wishlist (from localStorage)
            const isInWishlist = localStorage.getItem(`wishlist_${id}`) === 'true';

            if (!isInWishlist) {
                // Add to wishlist
                fetch(`/wishlist/add/${id}`, {
                    method: "POST"
                })
                .then(response => response.json())
                .then((data) => {
                    if (data.success) {
                        showToast(data.message || "", "success");
                        icon.classList.remove('far');
                        icon.classList.add('fas');
                        icon.style.color = '#dc3545';

                        // Save state
                        localStorage.setItem(`wishlist_${id}`, 'true');
                    }
                });
            } else {
                // Remove from wishlist
                fetch(`/wishlist/remove/${id}`, {
                    method: "DELETE"
                })
                .then(response => response.json())
                .then((data) => {
                    if (data.success) {
                        showToast(data.message || "", "success");
                        icon.classList.remove('fas');
                        icon.classList.add('far');
                        icon.style.color = '';

                        // Remove state
                        localStorage.setItem(`wishlist_${id}`, 'false');
                    }
                });
            }
        }
        function restoreWishlistIcons() {
            const wishlistIcons = document.querySelectorAll('.wishlist-icon');

            wishlistIcons.forEach(iconWrapper => {
                const icon = iconWrapper.querySelector('i');
                const productId = iconWrapper.dataset.id;

                if (localStorage.getItem(`wishlist_${productId}`) === 'true') {
                    icon.classList.remove('far');
                    icon.classList.add('fas');
                    icon.style.color = '#dc3545';
                } else {
                    icon.classList.remove('fas');
                    icon.classList.add('far');
                    icon.style.color = '';
                }
            });
        }


        
            // const stars = document.querySelectorAll('#starRating .star');
            // const ratingValue = document.getElementById('ratingValue');

            // stars.forEach(star => {
            //     star.addEventListener('click', () => {
            //         const val = parseInt(star.getAttribute('data-value'));
            //         highlightStars(val);
            //     });

            //     star.addEventListener('click', () => {
            //         const val = parseInt(star.getAttribute('data-value'));
            //         ratingValue.value = val;
            //         highlightStars(val);
            //     });
            // });

            // function highlightStars(value) {
            //     stars.forEach(star => {
            //         const starVal = parseInt(star.getAttribute('data-value'));
            //         star.classList.toggle('selected', starVal <= value);
            //     });
            // }


    </script>
</body>
</html>