<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add New Address | The Style</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <!-- Custom CSS -->
    <!-- <link rel="stylesheet" href="css/style.css">    -->
     <style>
        a{
         list-style: none;
         color: black;
         text-decoration: none;
            
        }
        li{
            list-style: none;
        }
     </style>
</head>
<body>
    <header>
        <nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top py-3">
            <div class="container">
                <a href=""><img style="width: 100px; height: 40px;" src="/adminassets/imgs/theme/logo.png" alt=""></a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav mx-auto">
                        <li class="nav-item">
                            <a class="nav-link active" href="/home">Home</a>
                        </li>
                        <li class="nav-item">
                            <% if (!user) { %>
                                <a class="nav-link" href="/login">Shop</a>
                                <% } else { %>
                                    <a class="nav-link" href="/products">Shop</a>
                            <% } %>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/brand">Brands</a>
                        </li>
                        <li class="nav-item">
                            <% if (!user) { %>
                                <a class="nav-link" href="/login">New Arrivals</a>
                                <% } else { %>
                                    <a class="nav-link" href="newarrival">New Arrivals</a>
                            <% } %>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">About</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Contact</a>
                        </li>
                    </ul>
                    <div class="d-flex">
                        <!-- <a href="#" class="nav-icon me-3"><i class="fas fa-search"></i></a> -->
                       <% if (user) { %>
                        <a href="/userDash" class="nav-icon me-3"><i class="fas fa-user"></i></a>
                       <% } %>
                        <% if (!user) { %>
                            <a href="/login" class="nav-icon me-3 position-relative">
                                <i class="fas fa-shopping-bag"></i>
                                <span class="cart-count"></span>
                            </a>
                            <% } else { %>
                                <a href="/cart" class="nav-icon me-3 position-relative">
                                    <i class="fas fa-shopping-bag"></i>
                                    <span class="cart-count"></span>
                                </a>
                        <% } %>
                        <% if (!user) { %>
                            <a href="/login" style="padding: 5px;font-size: 12px;font-weight: bold;" class="btn btn-dark btn-lg me-2 mb-2">Login</a>
                            <a href="/signup" style="padding: 5px;font-size: 12px;font-weight: bold;" class="btn btn-dark btn-lg me-2 mb-2">Signup</a>
                        <% } %>
                        <% if (user) { %>
                            <a href="/logout" style="padding: 5px;font-size: 12px;font-weight: bold;margin-left: 25px;" class="btn btn-dark btn-lg me-2 mb-2">Logout</a>
                           <% } %>
    
                    </div>
                </div>
            </div>
        </nav>
    </header>
    <!-- Add Address Content -->
    <section class="add-address-content py-5 ">
        <div class="container">
            <div class="row mt-5">
                <!-- Sidebar -->
                <div class="col-lg-3 mb-4 mb-lg-0">
                    <div class="account-sidebar">
                        <div class="user-profile text-center mb-4">
                            <div class="user-avatar mb-3">
                                <img src="/adminassets/imgs/people/ddd.png" alt="User Avatar" class="rounded-circle" width="80" height="80">
                            </div>
                            
                            <h5 class="user-name mb-1"><%= user.name %></h5>
                            <p class="user-email text-muted mb-0"><%= user.email %></p>
                        </div>
                        <div class="list-group">
                            <a href="/userDash" class="list-group-item list-group-item-action">
                                <i class="fas fa-tachometer-alt me-2"></i> My Profile
                            </a>
                            <a href="/myOrder" class="list-group-item list-group-item-action">
                                <i class="fas fa-shopping-bag me-2"></i> My Orders
                            </a>
                            <a href="/wishlist" class="list-group-item list-group-item-action">
                                <i class="fas fa-heart me-2"></i> My Wishlist
                            </a>
                            <a href="/address" class="list-group-item list-group-item-action active">
                                <i class="fas fa-map-marker-alt me-2"></i> My Addresses
                            </a>
                            <a href="/mywallet" class="list-group-item list-group-item-action">
                                <i class="fas fa-wallet me-2"></i> My Wallet
                            </a>
                            <a href="/logout" class="list-group-item list-group-item-action text-danger">
                                <i class="fas fa-sign-out-alt me-2"></i> Logout
                            </a>
                        </div>
                    </div>
                </div>
                
                <!-- Add Address Form -->
                <div class="col-lg-9">
                    <div class="add-address-form-container">
                        <div class="card border-0 shadow-sm">
                            <div class="card-header bg-white py-3">
                                <h4 class="mb-0">Add New Address</h4>
                            </div>
                            <div class="card-body p-4">
                                <form method="post" action="/address/add" id="formSubmit" >
                                    
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="firstName" class="form-label">First Name</label>
                                            <input type="text" class="form-control" name="firstName" id="firstName" placeholder="eg:- Abhraham" required>
                                            <span id="error-firstName" style="color: red;"></span>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="lastName" class="form-label">Last Name</label>
                                            <input type="text" class="form-control" name="lastName" id="lastName" placeholder="eg:- Kuraishi" required>
                                            <span id="error-lastName" style="color: red;"></span>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="addressName" class="form-label">Address Name</label>
                                            <input type="text" class="form-control" name="addressName" id="addressName" placeholder="Home, Office, etc." required>
                                            <span id="error-addressName" style="color: red;"></span>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="phoneNumber" class="form-label">Phone Number</label>
                                            <input type="tel" class="form-control" name="phoneNumber" id="phoneNumber" placeholder="+91 8080 808 808" required>
                                            <span id="error-phoneNumber" style="color: red;"></span>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="addressLine1" class="form-label">Address Line 1</label>
                                        <input type="text" class="form-control" name="addressLine" id="addressLine" placeholder="Street address, P.O. box, company name" required>
                                        <span id="error-addressLine" style="color: red;"></span>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-4 mb-3">
                                            <label for="city" class="form-label">City</label>
                                            <input type="text" class="form-control" name="city" id="city" placeholder="eg:- Kochi" required>
                                            <span id="error-city" style="color: red;"></span>
                                        </div>
                                        <div class="col-md-4 mb-3">
                                            <label for="state" class="form-label">State</label>
                                            <input type="text" class="form-control" name="state" id="state" placeholder="eg:- Ernankulam" required>
                                            <span id="error-state" style="color: red;"></span>
                                        </div>
                                        <div class="col-md-4 mb-3">
                                            <label for="zipCode" class="form-label">ZIP/Postal Code</label>
                                            <input type="text" class="form-control" name="zipCode" id="zipCode" placeholder="676121" required>
                                            <span id="error-zipCode" style="color: red;"></span>
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <label for="deliveryInstructions" class="form-label">Delivery Instructions (Optional)</label>
                                        <textarea class="form-control" name="deliveryInstructions" id="deliveryInstructions" rows="3" placeholder="Special instructions for delivery"></textarea>
                                    </div>  
                                    <div class="d-flex justify-content-end mt-4">
                                        <a href="/address" class="btn btn-outline-secondary me-2">Cancel</a>
                                        <button type="submit" class="btn btn-dark">Save Address</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <header>
        <nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top py-3">
            <div class="container">
                <a href=""><img style="width: 100px; height: 40px;" src="/adminassets/imgs/theme/logo.png" alt=""></a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav mx-auto">
                        <li class="nav-item">
                            <a class="nav-link active" href="/">Home</a>
                        </li>
                        <li class="nav-item">
                            <% if (!user) { %>
                                <a class="nav-link" href="/login">Shop</a>
                                <% } else { %>
                                    <a class="nav-link" href="/products">Shop</a>
                            <% } %>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/brand">Brands</a>
                        </li>
                        <li class="nav-item">
                            <% if (!user) { %>
                                <a class="nav-link" href="/login">New Arrivals</a>
                                <% } else { %>
                                    <a class="nav-link" href="/newarrival">New Arrivals</a>
                            <% } %>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">About</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Contact</a>
                        </li>
                    </ul>
                    <div class="d-flex">
                        <% if (user) { %>
                            <a href="/userDash" class="nav-icon me-3"><i class="fas fa-user"></i></a>
                           <% } %>
                        <% if (!user) { %>
                            <a href="/login" class="nav-icon me-3 position-relative">
                                <i class="fas fa-shopping-bag"></i>
                                <span class="cart-count">2</span>
                            </a>
                            <% } else { %>
                                <a href="/cart" class="nav-icon me-3 position-relative">
                                    <i class="fas fa-shopping-bag"></i>
                                     <% if (cart) { %>
                                  <span class="cart-count"><%= cart.products.length %></span>
                                  <% } else { %>
                                    <span class="cart-count">0</span>
                                <% } %>
                                </a>
                        <% } %>
                        <% if (!user) { %>
                            <a href="/login" style="padding: 5px;font-size: 12px;font-weight: bold;" class="btn btn-dark btn-lg me-2 mb-2">Login</a>
                            <a href="/signup" style="padding: 5px;font-size: 12px;font-weight: bold;" class="btn btn-dark btn-lg me-2 mb-2">Signup</a>
                        <% } %>
                        <% if (user) { %>
                            <a href="/logout" style="padding: 5px;font-size: 12px;font-weight: bold;margin-left: 25px;" class="btn btn-dark btn-lg me-2 mb-2">Logout</a>
                           <% } %>
    
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <!-- <script src="js/script.js"></script> -->
    <script>
        document.getElementById('formSubmit').addEventListener('submit',(e)=>{
            // e.preventDefault(); 
            const firstNameInput = document.getElementById('firstName');
            const lastNameInput = document.getElementById('lastName');
            const addressNameInput = document.getElementById('addressName');
            const phoneNumberInput = document.getElementById('phoneNumber');
            const addressLineInput = document.getElementById('addressLine');
            const cityInput = document.getElementById('city');
            const stateInput = document.getElementById('state');
            const zipCodeInput = document.getElementById('zipCode');



            const errorFirstName = document.getElementById('error-firstName');
            const errorLastName = document.getElementById('error-lastName');
            const errorAddressName = document.getElementById('error-addressName');
            const errorPhoneNumber = document.getElementById('error-phoneNumber');
            const errorAddressLine = document.getElementById('error-addressLine');
            const errorCity = document.getElementById('error-city');
            const errorState = document.getElementById('error-state');
            const errorZipCode = document.getElementById('error-zipCode');


            const errorElements = [errorFirstName, errorLastName, errorAddressName, errorPhoneNumber, errorAddressLine, errorCity, errorState, errorZipCode];
            errorElements.forEach(el => {
                el.style.display = '感知';
                el.textContent = '';
            });


            const firstName = firstNameInput.value.trim();
            const lastName = lastNameInput.value.trim();
            const addressName = addressNameInput.value.trim();
            let phoneNumber = phoneNumberInput.value.trim().replace(/[\s\-\+\(\)]/g, ''); 
            const addressLine = addressLineInput.value.trim();
            const city = cityInput.value.trim();
            const state = stateInput.value.trim();
            const zipCode = zipCodeInput.value.trim();

            let isValid = true;

 
            const nameRegex = /^[A-Za-z\s]{2,50}$/;
            if (!firstName) {
                errorFirstName.style.display = 'block';
                errorFirstName.textContent = 'First name is required';
                isValid = false;
            } else if (!nameRegex.test(firstName)) {
                errorFirstName.style.display = 'block';
                errorFirstName.textContent = 'First name must be 2-50 characters, letters and spaces only';
                isValid = false;
            }

            if (!lastName) {
                errorLastName.style.display = 'block';
                errorLastName.textContent = 'Last name is required';
                isValid = false;
            } else if (!nameRegex.test(lastName)) {
                errorLastName.style.display = 'block';
                errorLastName.textContent = 'Last name must be 2-50 characters, letters and spaces only';
                isValid = false;
            }

            const addressNameRegex = /^[A-Za-z\s]{2,50}$/;
            if (!addressName) {
                errorAddressName.style.display = 'block';
                errorAddressName.textContent = 'Address name is required';
                isValid = false;
            } else if (!addressNameRegex.test(addressName)) {
                errorAddressName.style.display = 'block';
                errorAddressName.textContent = 'Address name must be 2-50 characters, letters and spaces only';
                isValid = false;
            }

            const phoneRegex = /^\d{10}$/;
            if (!phoneNumber) {
                errorPhoneNumber.style.display = 'block';
                errorPhoneNumber.textContent = 'Phone number is required';
                isValid = false;
            } else if (!phoneRegex.test(phoneNumber)) {
                errorPhoneNumber.style.display = 'block';
                errorPhoneNumber.textContent = 'Phone number must be exactly 10 digits';
                isValid = false;
            } else if (!/^[6-9]/.test(phoneNumber)) {
                errorPhoneNumber.style.display = 'block';
                errorPhoneNumber.textContent = 'Phone number must start with 6, 7, 8, or 9';
                isValid = false;
            } else if (/^(\d)\1{9}$/.test(phoneNumber)) {
                errorPhoneNumber.style.display = 'block';
                errorPhoneNumber.textContent = 'Phone number cannot consist of the same digit repeated';
                isValid = false;
            }

            const addressLineRegex = /^[A-Za-z0-9\s,.\-/#]{5,100}$/;
            if (!addressLine) {
                errorAddressLine.style.display = 'block';
                errorAddressLine.textContent = 'Address line is required';
                isValid = false;
            } else if (!addressLineRegex.test(addressLine)) {
                errorAddressLine.style.display = 'block';
                errorAddressLine.textContent = 'Address line must be 5-100 characters, including letters, numbers, spaces, and ,.-/#';
                isValid = false;
            }

            const cityRegex = /^[A-Za-z\s]{2,50}$/;
            if (!city) {
                errorCity.style.display = 'block';
                errorCity.textContent = 'City is required';
                isValid = false;
            } else if (!cityRegex.test(city)) {
                errorCity.style.display = 'block';
                errorCity.textContent = 'City must be 2-50 characters, letters and spaces only';
                isValid = false;
            }

            const stateRegex = /^[A-Za-z\s]{2,50}$/;
            if (!state) {
                errorState.style.display = 'block';
                errorState.textContent = 'State is required';
                isValid = false;
            } else if (!stateRegex.test(state)) {
                errorState.style.display = 'block';
                errorState.textContent = 'State must be 2-50 characters, letters and spaces only';
                isValid = false;
            }

            const zipCodeRegex = /^\d{6}$/;
            if (!zipCode) {
                errorZipCode.style.display = 'block';
                errorZipCode.textContent = 'ZIP/Postal code is required';
                isValid = false;
            } else if (!zipCodeRegex.test(zipCode)) {
                errorZipCode.style.display = 'block';
                errorZipCode.textContent = 'ZIP/Postal code must be exactly 6 digits';
                isValid = false;
            }else if(zipCode === '000000'){
                errorZipCode.style.display = 'block';
                errorZipCode.textContent = 'ZIP/Postal code must be valid';
                isValid = false;
            }

            return isValid
        });
    
    </script>
</body>
</html>